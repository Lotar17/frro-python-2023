


ScreenManager:
    Screen:
        canvas:
            Color:
                rgba: 0,0,0,0
            Rectangle:
                pos: self.pos
                size: self.size
        name: "Menu"
        BoxLayout:
            padding: 20
            orientation: "vertical"
            GridLayout:
                id: grilla
                cols: 4
                size_hint_y: 0.9
                spacing: 20
            GridLayout:
                size_hint_y: 0.1
                rows: 1
                cols: 2
                Button:
                    text: "Cargar Video"
                    background_color: (1.0, 0.5, 0.0, 1.0)
                    color: 1, 1, 1, 1
                    on_press:
                        root.current = "Alta"
                Button:
                    text: "Salir"
                    on_press:
                        root.current = "player"
                        salir.state = "play"

    Screen:
        name: "Alta"
        BoxLayout:
            orientation: "vertical"
            BoxLayout:
                size_hint_y: 0.8
                orientation: "vertical"
                padding: 20
                Label:
                    text: "Nombre"
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                TextInput:
                    id: name
                    size_hint_y: None
                    height: max(self.minimum_height, self.line_height)

                Label:
                    text: "Descripcion"
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                TextInput:
                    size_hint_y: None
                    height: max(self.minimum_height, self.line_height)
                    id: desc
                Label:
                    text: "Propietario"
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                TextInput:
                    id: prop
                    size_hint_y: None
                    height: max(self.minimum_height, self.line_height)
                    multiline: False
                Label:
                    text: "Ruta"
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                TextInput:
                    id:route
                    size_hint_y: None
                    height: max(self.minimum_height, self.line_height)
                    multiline: False
                    valign: ""
                Button:
                    text: "Seleccione un archivo"
                    background_color: (1.0, 0.5, 0.0, 1.0)
                    on_press:
                        root.current = "chooser"
            BoxLayout:
                size_hint_y: 0.2
                orientation: "vertical"
                Button:
                    text: "GUARDAR"
                    background_color: (0.0, 1.0, 0.0, 1.0)
                    on_press:
                        app.cargar_video(name.text, desc.text, prop.text, route.text)
                        name.text = desc.text = prop.text = route.text = ""
                        app.build()
                        root.current = "Menu"
                Button:
                    text: "VOLVER"
                    on_press:
                        app.build()
                        root.current = "Menu"


    Screen:
        name: "chooser"
        FileChooserListView:
            id: filechooser
            path: app.defaultPath()
            filters: ['*.mp4','*.mkv']
            on_selection:
                route.text = self.selection and self.selection[0] or ''
                root.current = "Alta"

    Screen:
        name: "player"
        BoxLayout:
            orientation: "vertical"
            VideoPlayer:
                id: salir
                size_hint_y: 0.9
                source: "Videos TPI/rick-astley.mp4"
                options: {"eos" : "loop"}
                allow_stretch: True
            Button:
                size_hint_y: 0.1
                text: "Volver"
                on_press:
                    root.current = "Menu"
                    salir.state = "stop"
                    app.build()
